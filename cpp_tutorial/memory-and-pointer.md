# 메모리와 포인터

### 메모리란

> 메모리 셀의 연속과 같으며, 각 셀의 크기는 1바이트이며 고유한 주소가 있다.

c++에서는 변수의 메모리 주소를 출력해볼 수 있다.

```c++
int i;

int main() {
    cout << &i << "\n";
    i = 10
    cout << &i << "\n";
    return 0;
}
// 0x100bbc000
// 0x100bbc000
```

주소는 예약한 메모리 영역에 해당 값을 저장하게 된다.
그래서 어떤 값을 넣든 주소는 변하지 않는다.

### 포인터란

> 메모리 관리는 언어마다 조금은 다르게 관리된다. 자바, 파이썬, 자바스크립트에서는 개발자가 직접 변수에 메모리를 할당하거나 해제할 수 없고, 가비지컬렉터를 통해 이를 수행한다.

변수의 메모리 주소를 담는 타입이 바로 `포인터`다.
메모리 동적할당, 데이터를 복사하지 않고 함수 매개변수로 사용, 클래스 및 구조체를 연결할 때 사용된다.

### 역참조 연산자

> & 연산자로는 주소를 불러올 수 있고, \* 연산자로는 해당 주소값에 담긴 값을 불러올 수 있다.

```c++
int main() {
    string a = "abcde";
    string * b = &a;
    cout << b << "\n";
    cout << *b << "\n";

    return 0;
}
// 0x100bbc000
// abcde
```

### Array to Pointer Decay

배열이 포인터로 부식되는 현상을 말한다.
배열의 이름을 주소값으로 사용할 수 있다는 걸 의미한다.
이를 통해 배열의 이름은 배열의 첫 번째 주소로 사용이 가능하다.

```c++
int a[3] = {1,2,3};

int main() {
    int * c = a;
    cout << c << "\n";
    cout << &a[0] << "\n";
    return 0;
}
// 0x100bbc000
// 0x100bbc000
```

### 프로세스 메모리 구조

> 스택, 힙, 데이터 영역, 코드영역으로 나뉜다.

1. 스택

   지역 변수, 매개 변수, 함수가 저장되고 컴파일 시에 크기가 결정된다.
   그러나 함수가 함수를 호출하는 등에 따라 런타임시에도 크기가 변경된다.
   동적이다.

2. 힙

   동적 할당할 때 사용되며, 런타임 시 크기가 결정된다.
   동적이다.

3. 데이터 영역

   BSS 영역과 DATA 영역으로 나뉜다.
   정적 할당에 관한 부분을 담당한다.
   정적이다.

4. 코드 영역

   소스코드가 들어간다.
   정적이다.

### 정적할당

> 컴파일 단계에서 메모리를 할당한다. BSS segement, Data segment, code / text segment 세 가지로 나뉘어서 저장된다.

`BSS segment`

    전역 변수, static, const로 선언된 변수 중 0으로 초기화 또는 초기화가 어떤 값으로도 되어 있지 않은 변수들이 이 메모리 영역에 할당된다.

`Data segment`

    전역 변수, static, const로 선언된 변수 중 0이 아닌 값으로 초기화된 변수가 이 메모리 영역에 할당된다.

`code / text segment`

    프로그램의 코드가 들어간다.

### 동적할당

> 런타임 단계에서 메모리를 할당받는 것이며, Stack과 Heap으로 나뉜다.

`Stack`

    지역 변수, 매개 변수, 실행되는 함수에 의해 늘어나거나 줄어드는 메모리 영역이다.
    함수가 호출될 때마다 해당 환경 등 특정 정보가 여기에 계속 저장된다.
    재귀함수가 불렸다면, 새로운 스택 프레임이 매번 사용되기 때문에 함수 내의 변수 집합이 해당 함수의 다른 인스턴스 변수를 방해하지 않는다.
    즉, 재귀함수 내의 지역변수로 선언하게 되면, 해당 변수는 독립적으로 작용하며 다른 함수에 있는 변수에 영향을 미치지 않는다.

`Heap`

    동적으로 할당되는 변수들을 담는다.
    `malloc()`, `free()` 함수를 통해 관리가 가능하다.
    동적으로 관리되는 자료구조는 여기를 사용한다.
    `vector`가 여기에 속한다.
